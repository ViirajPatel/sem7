{% extends "layout 2.html" %}
{% block title %}
Dashboard
{% endblock %}
{% block start %}
<div class="container-fluid pb-3">
  <div class="d-grid gap-3" style="grid-template-columns: 2fr 1fr ; grid-template-rows: 1fr;">
   
    <div class="bg-light border rounded-3" style="overflow:auto">
      <script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
      <script>

        function searching(id) {
          // document.getElementById('search').value="";
          symbol = document.getElementById(id).value;
          console.log('onclick searching' + symbol);
          document.getElementById('search').value = symbol
          document.getElementById('sc').value = symbol;
        }
        async function fetching() {

          document.getElementById("companies").style.overflow = "scroll";
          document.getElementById("companies").style.height = "350px";
          console.log("fasdkghj")
          const response = await fetch("{{ url_for('static',filename='companies.json') }}");
          const data = await response.json();
          console.log(typeof (data));
          let a = " <input type='button' class='btn-close' onclick='clearf()'><table border =1  padding='10px' cellspacing=10px  id='myTable'>";
          for (let x = 0; x < 1628; x++) {
            a += "<tr><td><input style='width:100%' type='submit' class='btn btn btn-light' id='symbol" + x + "' onclick='searching(this.id)'  value=" + data["Symbol"][x] + "></td><td>" + data["CompanyName"][x] + "</td></tr>";
          }
          a += "</table>";
          console.log(a);
          document.getElementById("companies").innerHTML = a;


        }

        function myFunction() {


          var input, filter, table, tr, td, i, txtValue;
          input = document.getElementById("search");
          filter = input.value.toUpperCase();
          table = document.getElementById("myTable");
          tr = table.getElementsByTagName("tr");
          for (i = 0; i < tr.length; i++) {
            td = tr[i].getElementsByTagName("td")[0];
            if (td) {
              txtValue = td.textContent || td.innerText;
              if (txtValue.toUpperCase().indexOf(filter) > -1) {
                tr[i].style.display = "";
              } else {
                tr[i].style.display = "none";
              }
            }
          }
        }
        function clearf() {
          var valueBtn = document.getElementById("search").value;
          console.log(valueBtn)
          document.getElementById("companies").style.overflow = "scroll";
          document.getElementById("companies").style.height = "0px";
          // document.getElementById("companies").innerHTML = "";
          document.getElementById("search").value = valueBtn;
        }

      </script>

      <!-- <form action="/chart" method="post">
        <input type="search" name="search" id="search" onclick="fetching()" onkeyup="myFunction()">
        <input type="submit" value="Search">

      </form>
      <span id='sc'>{{err}}</span>
      <div id="companies">
      </div> -->
      <!-- TradingView Widget BEGIN -->
      
    
        <div class="tradingview-widget-container">
          <div id="tradingview_85c55"></div>
         
          <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
          <script type="text/javascript">
            new TradingView.MediumWidget(
              {
                "symbols": [
                  [
                    "SENSEX",
                    "INDEX:SENSEX|12M"
                  ]
                ],
                "chartOnly": false,
                "width": "100%",
                "height": "100%",
                "locale": "en",
                "colorTheme": "light",
                "gridLineColor": "rgba(240, 243, 250, 0)",
                "fontColor": "#787b86",
                "isTransparent": true,
                "autosize": false,
                "showFloatingTooltip": true,
                "showVolume": true,
                "scalePosition": "left",
                "scaleMode": "Normal",
                "fontFamily": "Trebuchet MS, sans-serif",
                "noTimeScale": false,
                "chartType": "candlesticks",
                "upColor": "#26a69a",
                "downColor": "#ef5350",
                "borderUpColor": "#26a69a",
                "borderDownColor": "#ef5350",
                "wickUpColor": "#26a69a",
                "wickDownColor": "#ef5350",
                "container_id": "tradingview_85c55"
              }
            );
          </script>
        </div>
        <!-- TradingView Widget END -->
      </div>
      <!-- TradingView Widget END -->
      <!-- TradingView Widget BEGIN -->
      <div class="bg-light border rounded-3" style="overflow:auto">
        <!-- TradingView Widget BEGIN -->
        <div class="tradingview-widget-container">
          <div class="tradingview-widget-container__widget"></div>

          <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-hotlists.js"
            async>
              {
                "colorTheme": "light",
                  "dateRange": "12M",
                    "exchange": "BSE",
                      "showChart": true,
                        "locale": "en",
                          "largeChartUrl": "",
                            "isTransparent": true,
                              "showSymbolLogo": false,
                                "showFloatingTooltip": false,
                                  "width": "100%",
                                    "height": "600",
                                      "plotLineColorGrowing": "rgba(41, 98, 255, 1)",
                                        "plotLineColorFalling": "rgba(41, 98, 255, 1)",
                                          "gridLineColor": "rgba(240, 243, 250, 0)",
                                            "scaleFontColor": "rgba(120, 123, 134, 1)",
                                              "belowLineFillColorGrowing": "rgba(41, 98, 255, 0.12)",
                                                "belowLineFillColorFalling": "rgba(41, 98, 255, 0.12)",
                                                  "belowLineFillColorGrowingBottom": "rgba(41, 98, 255, 0)",
                                                    "belowLineFillColorFallingBottom": "rgba(41, 98, 255, 0)",
                                                      "symbolActiveColor": "rgba(41, 98, 255, 0.12)"
              }
            </script>
        </div>
        <!-- TradingView Widget END -->

      </div>
    </div>


    <div class="bg-light border rounded-3" style="overflow: auto;">

      <style>
        iframe {
          border: 3px;
          align-self: center;
          height: 80vh;
          width: 100%;

        }
      </style>
      <script>

//     window.setTimeout(function () {
//   window.location.reload();
// }, 60000);


      </script>
      <!-- <div class="container"> -->
      <iframe
        src="https://docs.google.com/spreadsheets/d/e/2PACX-1vQYRipJ5REG7Na5wb1WeYd9SAh0_h915bJWKMeBHBZ0eYquh36INk-8w2uP5Yw0BM91p702_YV2qegK/pubhtml?widget=true&amp;headers=false"></iframe>
      <!-- </div> -->
    </div>
  </div>
</div>

{% endblock %}